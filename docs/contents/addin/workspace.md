# 🎉 『ワークスペース化』アドイン

* AviUtlの各ウィンドウを再帰分割可能なペインにドッキングできるようにします。

## 💡 基本的な使い方

* メインウィンドウのメニューで『その他』➡『workspace』をホバーすると`workspaceメニュー`が表示されます。
* ペインのキャプション、タブ、ボーダー(空きペインの場合は本体)を右クリックすると`ペインメニュー`が表示されます。

## 🍱 workspaceメニュー

### 🏷️ (ウィンドウカテゴリ)

* カテゴリの中からウィンドウを選択すると、そのウィンドウがフローティング状態で表示されます。

* `プライマリ` ✏️ AviUtlと拡張編集のウィンドウです。
* `セカンダリ` ✏️ AviUtlプラグインのウィンドウです。
* `サブウィンドウ` ✏️ ユーザーが作成したサブウィンドウです。
* `サブプロセス` ✏️ `config/workspace.aua.json`で設定されているサブプロセスのウィンドウです。
* `アルティメット` ✏️ アルティメットプラグイン関連のウィンドウです。

### 🏷️ 再生時にプレビューを最大化

1. まず、`workspaceの設定`で`『再生中にプレビューを最大化』機能を有効化`にチェックを入れます。
1. その状態でこのメニュー項目にもチェックをいれると、再生時にプレビュー(AviUtlウィンドウまたは再生ウィンドウ)が最大化されて表示されるようになります。

### 🏷️ サブウィンドウを新規作成

* メインウィンドウとほぼ同じ機能のウィンドウを作成します。

### 🏷️ レイアウトのインポート

* レイアウトファイルを選択してインポートします。
* Shiftキーを押しながらメニューアイテムを選択した場合は、ボーダーの色などの設定もすべてインポートします。

### 🏷️ レイアウトのエクスポート

* レイアウトファイルを選択してエクスポートします。

### 🏷️ workspaceの設定

* ワークスペース化アドインの設定ダイアログを開きます。

* `配色` ✏️ 背景色とボーダーの配色を指定します。
	* `塗り潰し` ✏️ 背景色を指定します。
	* `ボーダー` ✏️ ボーダーの色を指定します。
	* `ホットボーダー` ✏️ ホットボーダーの色を指定します。
* `アクティブキャプションの配色` ✏️ アクティブキャプションの配色を指定します。
	* `背景` ✏️ アクティブキャプションの背景色を指定します。
	* `テキスト` ✏️ アクティブキャプションのテキストの色を指定します。
* `非アクティブキャプションの配色` ✏️ 非アクティブキャプションの配色を指定します。
	* `背景` ✏️ 非アクティブキャプションの背景色を指定します。
	* `テキスト` ✏️ 非アクティブキャプションのテキストの色を指定します。
* `その他`
	* `ボーダーの幅` ✏️ ペインを分割するボーダーの幅を指定します。
	* `タイトルの高さ` ✏️ ペイン上部のタイトルの高さを指定します。
	* `タブの高さ` ✏️ タブの高さを指定します。
	* `タブモード` ✏️ タブモードを指定します。
	* `レイアウトリスト` ✏️ レイアウトリストの表示位置を指定します。
* `配色ではなくテーマを使用する` ✏️ チェックを入れると、描画を『ダークモード化』アドインに任せます。
* `マウスホイール時スクロールを優先する` ✏️ チェックを入れると、コンボボックスなどの上でマウスホイールをしてもスクロールが優先されます。
* `『再生中にプレビューを最大化』機能を有効化` ✏️ チェックを入れると、workspaceメニューの『再生中にプレビューを最大化』が選択できるようになります。
* `キーボードメッセージをバイパスする` ✏️ エディットボックス以外のウィンドウのキーボードメッセージを拡張編集ウィンドウへバイパスします。

## 🍱 ペインメニュー

### 🏷️ (ウィンドウカテゴリ)

* カテゴリの中からウィンドウを選択すると、そのウィンドウがペインにドッキングします。

----

### 🏷️ 分割なし

* ペインの分割を解除します。
* 子ペインは削除され、そこにドッキングしていたウィンドウはフローティング状態になります。

### 🏷️ 左右に分割
### 🏷️ 上下に分割

* 垂直ボーダーを作成し、ペインを左右に分割します。
* または、水平ボーダーを作成し、ペインを上下に分けます。
* 分割されたペインは同じ手順で更に分割することができます。

----

### 🏷️ 左上を原点にする
### 🏷️ 右下を原点にする

* ペインをリサイズしたときの挙動を設定します。

----

### 🏷️ 左に移動する
### 🏷️ 右に移動する

タブ項目を左右に移動します。

### 🏷️ ボーダーをロックする

* 普通にクリックしてもボーダーが動かないようにします。
* ただし、Ctrlキーを押しているときはロックしていてもドラッグできます。

### 🏷️ 名前を変更

* サブウィンドウの名前を変更します。
* ※他のウィンドウと重複する名前は使用できません。
* `%ウィンドウ名%`はそのウィンドウの現在のタイトルと置換されます。
* 例えば、
```
これは「%拡張編集%」と「%設定ダイアログ%」のテストです
```
と名付けた場合、サブウィンドウのタイトルは
```
これは「拡張編集 [00:00:00.00] [1/1000]」と「動画ファイル[標準描画]」のテストです
```
のように表示されます。
* ただし、他のサブウィンドウの名前は参照できません。

### 🏷️ レイアウトを固定化

* このウィンドウのレイアウトを固定します。
* 固定化されているウィンドウはレイアウトをインポートしたとき、読み込まれません。

----

### 🏷️ ドッキングを解除

* ドッキングしているウィンドウがフローティング状態になります。

## 💡 その他の使い方

### 🏷️ 特定のウィンドウが表示されなくなった場合

1. そのウィンドウを一旦ドッキングさせます。
1. そのウィンドウのドッキングを解除します。

### 🏷️ ドッキング状態でメニューを使用する

1. ペインの左上にある「︙」を左クリックしてメニューを表示します。

### 🏷️ フローティングしているサブウィンドウをリネームする

1. サブウィンドウのキャプションを右クリックしてシステムメニューを表示します。
1. 「名前を変更」を選択します。

### 🏷️ サブウィンドウを削除する

1. Shiftキーを押しながらサブウィンドウの✕ボタンを押します。
1. サブウィンドウがどこにあるのか分からない場合は、Shiftキーを押しながら`メインメニュー`でサブウィンドウを選択します。

### 🏷️ 再生時にプレビューを最大化する

1. AviUtlを起動する前に`config/workspace.aua.json`で`use_fullscreen_player`を`true`に設定します。
1. workspaceメニューの`再生時にプレビューを最大化`にチェックを入れます。
1. この状態で再生すると、AviUtlウィンドウまたは再生ウィンドウが最大化されて表示されます。

### 🏷️ ペインを最大化する

1. ペインのタイトルかタブをダブルクリックするとそのペインが最大化されます。
1. もう一度ダブルクリックすると元に戻ります。

### 🏷️ ペインのキャプションを非表示にする

* `Shift+Win+Z`キーを押すとカーソル位置にあるペインのキャプションの表示状態が切り替わります。
* キーは`config/workspace.aua.json`で変更できます。

## 📝 設定ファイル

* AviUtlを起動する前に`config/workspace.aua.json`をテキストエディタで編集します。

* `use_fullscreen_preview` ✏️ 『再生時にプレビューを最大化』機能自体の有効/無効を指定します。
	* `true`を指定するとworkspaceメニューに『再生時にプレビューを最大化』の項目が表示されるようになります。
* `shortcut_key`
	* `show_caption` ✏️ キャプションの表示状態を切り替えるショートカットキーです。
		* `key` ✏️ 仮想キーコードを指定します。
		* `mod` ✏️ 修飾キーを指定します。`SHIFT` `CTRL` `ALT` `WIN`を組み合わせて指定します。
* `sub_process` ✏️ ドッキングするサブプロセスを指定します。
	* `active` ✏️ `true`を指定するとサブプロセスをドッキングできるようになります。
	* `type`
		* `console` ✏️ コンソールウィンドウの場合はこの値を指定する必要があります。
		* `psdtoolkit` ✏️ PSDToolKitウィンドウの場合はこの値を指定する必要があります。
	* `name` ✏️ ウィンドウの名前を指定します。
	* `class_name` ✏️ ウィンドウの検索に使用するクラス名を指定します。
	* `window_name` ✏️ ウィンドウの検索に使用するウィンドウ名を指定します。
	* `exit_mode` ✏️ 終了時の動作を指定します。
		* `detach` ✏️ 終了時にサブプロセスのウィンドウが破壊されないようにデタッチします。
		* `close` ✏️ 終了時にサブプロセスのウィンドウにWM_CLOSEを送信します。
		* `quit` ✏️ 終了時にサブプロセスのウィンドウにWM_QUITを送信します。
		* `destroy` ✏️ 終了時にサブプロセスのウィンドウを破壊します。
		* `terminate` ✏️ 終了時にサブプロセスを強制的に消去します。
	* `path` ✏️ サブプロセスのファイルパスを指定します。

## 📝 プリファレンスファイル(レイアウトファイル)

* AviUtlを起動する前に`config/workspace.preference.json`をテキストエディタで編集します。

* `border_width` ✏️ ボーダーの幅を指定します。
* `caption_height` ✏️ キャプションの高さを指定します。
* `tab_height` ✏️ タブの高さを指定します。
* `tab_mode`
	* `caption` ✏️ キャプションにタブを表示します。
	* `top` ✏️ ペインの上側にタブを表示します。
	* `bottom` ✏️ ペインの下側にタブを表示します。
* `layout_list`
	* `none` ✏️ レイアウトリストを非表示にします。
	* `top` ✏️ メインウィンドウの上側にレイアウトリストを表示します。
	* `bottom` ✏️ メインウィンドウの下側にレイアウトリストを表示します。
* `fill_color` ✏️ 背景の塗りつぶし色を指定します。
* `border_color` ✏️ ボーダーの色を指定します。
* `hot_border_color` ✏️ ホット状態のボーダーの色を指定します。
* `active_caption_color` ✏️ アクティブキャプションの背景色を指定します。
* `active_caption_text_color` ✏️ アクティブキャプションのテキストの色を指定します。
* `inactive_caption_color` ✏️ 非アクティブキャプションの背景色を指定します。
* `inactive_caption_text_color` ✏️ 非アクティブキャプションのテキストの色を指定します。
* `use_theme` ✏️ `true`を指定するとUIの描画にテーマを使用するようになります。
* `scroll_force` ✏️ `true`を指定するとマウスホイール時スクロールを優先します。
* `main_window`
	* `placement` ✏️ メインウィンドウの位置を指定します。
		* ウィンドウ位置がおかしくなってしまった場合はこの要素を削除してください。
	* `root_pane` ✏️ ルートペインの設定です。
		* `is_solid` ✏️ `true`を指定するとレイアウトのインポート時にレイアウトが読み込まれず、そのまま残ります。
		* `split_mode` ✏️ `none`、`vert`、`horz`のいずれかを指定します。
		* `origin` ✏️ `top_left`、`bottom_right`のいずれかを指定します。
		* `caption_mode` ✏️ `hide`、`show`のいずれかを指定します。
		* `border` ✏️ `origin`からの相対値でボーダーの座標を指定します。
		* `is_border_locked` ✏️ `true`を指定するとボーダーをロックします。
		* `dock_shuttle` ✏️ このペインにドッキングさせるウィンドウを指定します。
		* `pane` ✏️ 子ペインの配列です。`root_pane`とほぼ同じ設定ができます。
* `sub_window` ✏️ サブウィンドウの配列です。`main_window`とほぼ同じ設定ができます。
* `float_shuttle` ✏️ フローティングウィンドウの位置を指定します。
	* ウィンドウ位置がおかしくなってしまった場合はこの要素を削除してください。

## 📝 レイアウトフォルダ

* `config/workspace/layout`にレイアウトファイルを作成すると、そのファイルをレイアウトリストから選択できるようになります。<br>
